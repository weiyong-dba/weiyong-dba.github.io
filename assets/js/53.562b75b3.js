(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{424:function(e,s,t){"use strict";t.r(s);var a=t(51),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"aerospike加载数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aerospike加载数据"}},[e._v("#")]),e._v(" Aerospike加载数据")]),e._v(" "),t("h2",{attrs:{id:"安装aerospike-loader"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装aerospike-loader"}},[e._v("#")]),e._v(" 安装aerospike-loader")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git clone https://github.com/aerospike/aerospike-loader.git\n$ cd aerospike-loader\n$ ./build\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("h2",{attrs:{id:"编写配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写配置文件"}},[e._v("#")]),e._v(" 编写配置文件")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('{\n  "version" : "2.0",\n  "dsv_config": { "delimiter": "|" , "n_columns_datafile": 9, "header_exist": true},\n\n  "mappings": [\n      {\n          "key": {"column_name":"o_orderkey", "type": "integer"},\n\n          "set": "orders",\n\n          "bin_list": [\n            {"name": "o_custkey",\n             "value": { "column_name": "o_custkey", "type" : "integer"}\n            },\n            {"name": "o_orderstatus",\n             "value": { "column_name": "o_orderstatus", "type" : "string"}\n            },\n            {"name": "o_totalprice",\n             "value": { "column_name": "o_totalprice", "type" : "float"}\n            },\n            {"name": "o_orderdate",\n             "value": { "column_name": "o_orderdate", "type" : "timestamp", "encoding":"yyyy-MM-dd", "dst_type": "integer"}\n            },\n            {"name": "orderpriority",\n             "value": { "column_name": "o_orderpriority", "type" : "string"}\n            },\n             {"name": "o_clerk",\n             "value": { "column_name": "o_clerk", "type" : "string"}\n            },\n             {"name": "o_shippriority",\n             "value": { "column_name": "o_shippriority", "type" : "integer"}\n            },\n            {"name": "o_comment",\n             "value": { "column_name": "o_comment", "type" : "string"}\n            }\n          ]\n      }\n  ]\n}\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br"),t("span",{staticClass:"line-number"},[e._v("24")]),t("br"),t("span",{staticClass:"line-number"},[e._v("25")]),t("br"),t("span",{staticClass:"line-number"},[e._v("26")]),t("br"),t("span",{staticClass:"line-number"},[e._v("27")]),t("br"),t("span",{staticClass:"line-number"},[e._v("28")]),t("br"),t("span",{staticClass:"line-number"},[e._v("29")]),t("br"),t("span",{staticClass:"line-number"},[e._v("30")]),t("br"),t("span",{staticClass:"line-number"},[e._v("31")]),t("br"),t("span",{staticClass:"line-number"},[e._v("32")]),t("br"),t("span",{staticClass:"line-number"},[e._v("33")]),t("br"),t("span",{staticClass:"line-number"},[e._v("34")]),t("br"),t("span",{staticClass:"line-number"},[e._v("35")]),t("br"),t("span",{staticClass:"line-number"},[e._v("36")]),t("br"),t("span",{staticClass:"line-number"},[e._v("37")]),t("br"),t("span",{staticClass:"line-number"},[e._v("38")]),t("br"),t("span",{staticClass:"line-number"},[e._v("39")]),t("br")])]),t("p",[t("strong",[e._v("支持的数据类型：")])]),e._v(" "),t("ul",[t("li",[e._v("Specify the delimiter (the separator character between two bin values), n_columns_datafile (number of columns in the data file), header_exist (true if a header exists in the data file.)")]),e._v(" "),t("li",[e._v("Bin_list contains an array of bin mappings. In each bin mapping there are two entries: 1) Aerospike bin name and 2) Value, which is the bin content mapping. If one column mapping is absent in the config file then that column will be skipped while loading.")]),e._v(" "),t("li",[e._v("Either column_name or column_position can be used to specify the column.")]),e._v(" "),t("li",[e._v("Native data types integer and string are stored as-is.\n"),t("ul",[t("li",[e._v("add the following line to binlist in the config file for _integer data type:\n"),t("ul",[t("li",[e._v('{"name": "age", "value": { "column_name": "age", "type" : "integer"}}')])])]),e._v(" "),t("li",[e._v("add the following line to binlist in the config file for _string data type:\n"),t("ul",[t("li",[e._v('{"name": "location", "value": { "column_name": "user_location", "type" : "string"}}')])])])])]),e._v(" "),t("li",[e._v("Data types other than native types:\n"),t("ul",[t("li",[e._v("add the following line to binlist in the config file for _blob data type. Data in data file should be in hex format:\n"),t("ul",[t("li",[e._v('{"name": "name_blob", "value": {"column_name": "user_name_blob", "type" : "blob", "dst_type" : "blob" , "encoding":"hex"} }')])])]),e._v(" "),t("li",[e._v("add the following line to binlist in the config file for _float data type:\n"),t("ul",[t("li",[e._v('{"name": "rating", "value": {"column_name": "user_rating", "type" : "float"} }')])])]),e._v(" "),t("li",[e._v("add the following line to binlist in the config file for _timestamp type data and store it as an integer:\n"),t("ul",[t("li",[e._v('{ "name": "recent_visit", "value": {"column_name": "last_visited", "type" : "timestamp", "encoding":"MM/dd/yy", "dst_type": "integer"} }')])])]),e._v(" "),t("li",[e._v("add the following line to binlist in the config file for _timestamp type data and store it as a string:\n"),t("ul",[t("li",[e._v('{ "name": "recent_visit", "value": {"column_name": "last_visited", "type" : "timestamp", "encoding":"MM/dd/yy", "dst_type": "string"} }')])])])])]),e._v(" "),t("li",[e._v("Specify static set name in the config file as follows:\n"),t("ul",[t("li",[e._v('"set": "setnameforall",')])])])]),e._v(" "),t("h2",{attrs:{id:"准备数据文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备数据文件"}},[e._v("#")]),e._v(" 准备数据文件")]),e._v(" "),t("p",[e._v("example.txt")]),e._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("o_orderkey|o_custkey|o_orderstatus|o_totalprice|o_orderdate|o_orderpriority|o_clerk|o_shippriority|o_comment\n1|3689999|O|224560.83|1996-01-02|5-LOW|Clerk#000095055|0|nstructions sleep furiously among \n2|7800163|O|75388.65|1996-12-01|1-URGENT|Clerk#000087916|0| foxes. pending accounts at the pending, silent asymptot\n3|12331391|F|255287.36|1993-10-14|5-LOW|Clerk#000095426|0|sly final accounts boost. carefully regular ideas cajole carefully. depos\n4|13677602|O|43119.84|1995-10-11|5-LOW|Clerk#000012340|0|sits. slyly regular warthogs cajole. regular, regular theodolites acro\n5|4448479|F|125809.76|1994-07-30|5-LOW|Clerk#000092480|0|quickly. bold deposits sleep slyly. packages use slyly\n6|5562202|F|56408.20|1992-02-21|4-NOT SPECIFIED|Clerk#000005798|0|ggle. special, final requests are against the furiously specia\n7|3913430|O|240358.24|1996-01-10|2-HIGH|Clerk#000046961|0|ly special requests\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("h2",{attrs:{id:"运行加载数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行加载数据"}},[e._v("#")]),e._v(" 运行加载数据")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("./run_loader -n test -c config.json example.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("strong",[e._v("运行结果")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("INFO  AerospikeLoad    :790 - Reader completed 150000001-lines in 842.310sec, From file: example.txt\nINFO  AerospikeLoad    :424 - Reader thread pool terminated\nINFO  AerospikeLoad    :428 - Shutdown writer thread pool\nINFO  AerospikeLoad    :431 - Writer thread pool terminated\nINFO  AerospikeLoad    :434 - Final Statistics of importer: (Records Read = 150000000, Successful Writes = 149999833, Successful Primary Writes = 149999833, Successful Mapping Writes = 0, Errors = 167(167-Write,0-Read,0-Processing), Skipped = 0(0-NullKey,0-NoBins)\nINFO  AerospikeLoad    :253 - Aerospike loader completed\nINFO  AerospikeLoad    :260 - Loader completed in 842.541sec\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[t("strong",[e._v("资源占用情况")])]),e._v(" "),t("p",[e._v("原始数据大小：17GB（1.5亿行）\nAS内存：8G\nAS磁盘：64G")]),e._v(" "),t("h2",{attrs:{id:"选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[e._v("#")]),e._v(" 选项")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Options\tDescription\tDefault\n-h <hosts>\tList of seed hosts, where Aerospike servers are running\t127.0.0.1\n-p <port>\tPort to use with the host specified in the -h option.\t3000\n-U <user>\tUser name\t\n-P <password>\tPassword\t\n-n <namespace>\tNamespace to load data into.\ttest\n-c <config>\tJSON formatted configuration file specifying parsing attributes and schema mapping.\t\n-g <max-throughput>\tSet a maximum target transactions per second for the loader.\t0 (no throttling)\n-T <transaction-timeout>\t(In milliseconds) Timeout for a transaction during write operation.\t0 (no timeout)\n-e <expiration-time>\tExpiration time of records in seconds. Other valid values are: set it to -1 for records to never expire and 0 to use server default.\t-1\n-tz <timezone>\tTime zone of data backup source. This value is used when loading data of timestamp datatype. For example, if data backup location timezone is X and that data is to be loaded into server located in Y timezone, then specify X's timezone. Valid values are standard three-letter codes such as PST, EST, etc.\tlocal timezone\n-ec <abort-error-count>\tError threshold to determine when the loader should stop loading data. Set it to 0 to ignore the threshold.\t0\n-wa <write-action>\tThe possible values are: 1) UPDATE - Create or update records. Merge incoming bin values with existing ones, 2) UPDATE_ONLY - Update existing records. Fail if record does not exist. Merge incoming bin values with existing ones, 3) REPLACE - Create or replace existing records, 4) REPLACE_ONLY - Replace existing records. Fail if record does not exist, 5) CREATE_ONLY - Create new records. Fail if record already exists.\tUPDATE\n-tls <tls-enable>\tUse TLS/SSL sockets\tFalse\n-tlsLoginOnly\tUse TLS/SSL sockets on node login only\tFalse\n-tp <tls-protocols>\tAllow TLS protocols. Values: TLSv1,TLSv1.1,TLSv1.2 separated by comma\tTLSv1.2)\n-tlsCiphers <tls-cipher-suite>\tAllow TLS cipher suites. Values: cipher names defined by JVM separated by comma\tnull (default cipher list provided by JVM)\n-tr <tls-revoke>\tRevoke certificates identified by their serial number. Values: serial numbers separated by comma\tnull (Do not revoke certificates)\n-uk <send-user-key>\tSend user defined key in addition to hash digest to store on the server. (default: userKey is not sent to reduce meta-data overhead).\t\n-v\tVerbose mode. If this option is specified, verbose mode is enabled and additional information is displayed on the console.\tDISABLED\n-u\tDisplay command usage.\t\n-V\tPrint the asloader version.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);