<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Centos下实现百万QPS的Aerospike集群 | 韦勇的博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="DBA，程序员，专注于IT互联网，大数据，包括但不限于数据库、Python等。">
    <meta name="keywords" content="DBA博客,个人技术博客,数据库,前端开发,前端框架,web前端,技术文档,学习,mysql,redis,mongodb,postgresql,greenplum,aerospike,scylladb,vertica,Python,JavaScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.c231a23d.css" as="style"><link rel="preload" href="/assets/js/app.b45ba360.js" as="script"><link rel="preload" href="/assets/js/2.6eac6864.js" as="script"><link rel="preload" href="/assets/js/3.a88a92d5.js" as="script"><link rel="preload" href="/assets/js/49.7ee1a812.js" as="script"><link rel="prefetch" href="/assets/js/10.9ac750bc.js"><link rel="prefetch" href="/assets/js/11.d59f0158.js"><link rel="prefetch" href="/assets/js/12.8cb6333d.js"><link rel="prefetch" href="/assets/js/13.8d09723d.js"><link rel="prefetch" href="/assets/js/14.489067bb.js"><link rel="prefetch" href="/assets/js/15.67863306.js"><link rel="prefetch" href="/assets/js/16.7bf247d8.js"><link rel="prefetch" href="/assets/js/17.121f6b76.js"><link rel="prefetch" href="/assets/js/18.4a67525f.js"><link rel="prefetch" href="/assets/js/19.99a721fb.js"><link rel="prefetch" href="/assets/js/20.4d4ffe62.js"><link rel="prefetch" href="/assets/js/21.988d351d.js"><link rel="prefetch" href="/assets/js/22.1e452d5b.js"><link rel="prefetch" href="/assets/js/23.705c804a.js"><link rel="prefetch" href="/assets/js/24.4160caef.js"><link rel="prefetch" href="/assets/js/25.c0cead69.js"><link rel="prefetch" href="/assets/js/26.8474fcb9.js"><link rel="prefetch" href="/assets/js/27.68577f4d.js"><link rel="prefetch" href="/assets/js/28.76404f22.js"><link rel="prefetch" href="/assets/js/29.29ebfa2e.js"><link rel="prefetch" href="/assets/js/30.42cb86c5.js"><link rel="prefetch" href="/assets/js/31.e9a9f49e.js"><link rel="prefetch" href="/assets/js/32.a1c8cda8.js"><link rel="prefetch" href="/assets/js/33.de67351d.js"><link rel="prefetch" href="/assets/js/34.72daac17.js"><link rel="prefetch" href="/assets/js/35.0d28f4f7.js"><link rel="prefetch" href="/assets/js/36.f50a6e95.js"><link rel="prefetch" href="/assets/js/37.0cb9802c.js"><link rel="prefetch" href="/assets/js/38.14a9b8c9.js"><link rel="prefetch" href="/assets/js/39.7f29c316.js"><link rel="prefetch" href="/assets/js/4.c2705a33.js"><link rel="prefetch" href="/assets/js/40.4bd4ac79.js"><link rel="prefetch" href="/assets/js/41.beb899d2.js"><link rel="prefetch" href="/assets/js/42.92fd262d.js"><link rel="prefetch" href="/assets/js/43.f93ed735.js"><link rel="prefetch" href="/assets/js/44.37e9f48e.js"><link rel="prefetch" href="/assets/js/45.171bf2c1.js"><link rel="prefetch" href="/assets/js/46.ab0fa104.js"><link rel="prefetch" href="/assets/js/47.2bd4da2a.js"><link rel="prefetch" href="/assets/js/48.6f1ece74.js"><link rel="prefetch" href="/assets/js/5.4c01046b.js"><link rel="prefetch" href="/assets/js/50.4ea52293.js"><link rel="prefetch" href="/assets/js/51.b5737a73.js"><link rel="prefetch" href="/assets/js/52.a8911a99.js"><link rel="prefetch" href="/assets/js/53.562b75b3.js"><link rel="prefetch" href="/assets/js/54.43b31295.js"><link rel="prefetch" href="/assets/js/55.722f0ac0.js"><link rel="prefetch" href="/assets/js/56.dd56fc0d.js"><link rel="prefetch" href="/assets/js/57.51f8e820.js"><link rel="prefetch" href="/assets/js/58.a6751fea.js"><link rel="prefetch" href="/assets/js/59.5b67abf1.js"><link rel="prefetch" href="/assets/js/6.38f9d1c7.js"><link rel="prefetch" href="/assets/js/60.40b9f1c0.js"><link rel="prefetch" href="/assets/js/61.cf3bc22e.js"><link rel="prefetch" href="/assets/js/62.ee744d9e.js"><link rel="prefetch" href="/assets/js/63.ecae0239.js"><link rel="prefetch" href="/assets/js/64.2e99c3e7.js"><link rel="prefetch" href="/assets/js/65.b3515acb.js"><link rel="prefetch" href="/assets/js/66.0c5c25c6.js"><link rel="prefetch" href="/assets/js/67.b90820e6.js"><link rel="prefetch" href="/assets/js/68.9d0729eb.js"><link rel="prefetch" href="/assets/js/69.751b150c.js"><link rel="prefetch" href="/assets/js/7.e34b3bc8.js"><link rel="prefetch" href="/assets/js/70.67171620.js"><link rel="prefetch" href="/assets/js/71.59324e4a.js"><link rel="prefetch" href="/assets/js/72.d931ea49.js"><link rel="prefetch" href="/assets/js/73.82b3b67b.js"><link rel="prefetch" href="/assets/js/74.55622a29.js"><link rel="prefetch" href="/assets/js/75.4130e842.js"><link rel="prefetch" href="/assets/js/76.c5f76e21.js"><link rel="prefetch" href="/assets/js/8.d51727c6.js"><link rel="prefetch" href="/assets/js/9.44347f46.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c231a23d.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">韦勇的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统" class="dropdown-title"><a href="/system/" class="link-title">系统</a> <span class="title" style="display:none;">系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>系统文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/654590/" class="nav-link">Linux维护手册</a></li><li class="dropdown-subitem"><a href="/pages/85d59c/" class="nav-link">使用iotune测试磁盘读写</a></li><li class="dropdown-subitem"><a href="/pages/45c411/" class="nav-link">源码编译gcc</a></li><li class="dropdown-subitem"><a href="/pages/187f4d/" class="nav-link">YCSB压测</a></li><li class="dropdown-subitem"><a href="/pages/ca2bd6/" class="nav-link">write ahead</a></li></ul></li><li class="dropdown-item"><h4>编程开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages//" class="nav-link">编程开发</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><a href="/mysql/" class="link-title">MySQL</a> <span class="title" style="display:none;">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>运维相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a6ac55/" class="nav-link">部署</a></li></ul></li><li class="dropdown-item"><h4>HA</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/c78f1b/" class="nav-link">HA选型</a></li><li class="dropdown-subitem"><a href="/pages/0439fa/" class="nav-link">MGR</a></li></ul></li><li class="dropdown-item"><h4>备份恢复</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a0df55/" class="nav-link">备份恢复实践</a></li></ul></li><li class="dropdown-item"><h4>笔记文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ee31c0/" class="nav-link">MySQL8新特性</a></li><li class="dropdown-subitem"><a href="/pages/08b679/" class="nav-link">SQL优化</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PostgreSQL" class="dropdown-title"><a href="/postgresql/" class="link-title">PostgreSQL</a> <span class="title" style="display:none;">PostgreSQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>运维相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/859ac7/" class="nav-link">部署</a></li><li class="dropdown-subitem"><a href="/pages/2373b5/" class="nav-link">运维手册</a></li></ul></li><li class="dropdown-item"><h4>备份恢复</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/96963a/" class="nav-link">备份恢复实践</a></li></ul></li><li class="dropdown-item"><h4>源码开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ddbfb5/" class="nav-link">统计SQL执行耗时分位</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><a href="/distributed/" class="link-title">分布式</a> <span class="title" style="display:none;">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Greenplum</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/441817/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/dee4e3/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/4bb09b/" class="nav-link">维护手册</a></li><li class="dropdown-subitem"><a href="/pages/84a443/" class="nav-link">监控指标</a></li></ul></li><li class="dropdown-item"><h4>Scylladb</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2cae68/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/342275/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/95d8cc/" class="nav-link">维护手册</a></li><li class="dropdown-subitem"><a href="/pages/e27c40/" class="nav-link">数据迁移</a></li><li class="dropdown-subitem"><a href="/pages/cf45d3/" class="nav-link">监控部署</a></li></ul></li><li class="dropdown-item"><h4>Aerospike</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bd9ddc/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/80ee1a/" aria-current="page" class="nav-link router-link-exact-active router-link-active">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/9ba431/" class="nav-link">管理手册</a></li><li class="dropdown-subitem"><a href="/pages/76e199/" class="nav-link">ACT测试</a></li><li class="dropdown-subitem"><a href="/pages/4131aa/" class="nav-link">源码编译</a></li><li class="dropdown-subitem"><a href="/pages/75d8ce/" class="nav-link">数据加载</a></li></ul></li><li class="dropdown-item"><h4>Vertica</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b023ab/" class="nav-link">安装部署</a></li></ul></li><li class="dropdown-item"><h4>Tidb</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a52d49/" class="nav-link">数据迁移</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NoSQL" class="dropdown-title"><a href="/nosql/" class="link-title">NoSQL</a> <span class="title" style="display:none;">NoSQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Redis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b9b610/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/5cdb24/" class="nav-link">性能测试</a></li><li class="dropdown-subitem"><a href="/pages/52f09b/" class="nav-link">运维手册</a></li><li class="dropdown-subitem"><a href="/pages/855952/" class="nav-link">安全加固</a></li><li class="dropdown-subitem"><a href="/pages/fea0b7/" class="nav-link">HA</a></li><li class="dropdown-subitem"><a href="/pages/dee4e3/" class="nav-link">新特性</a></li></ul></li><li class="dropdown-item"><h4>MongoDB</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/61caf7/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/e25894/" class="nav-link">HA</a></li><li class="dropdown-subitem"><a href="/pages/7de6de/" class="nav-link">运维手册</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程开发" class="dropdown-title"><a href="/dev/" class="link-title">编程开发</a> <span class="title" style="display:none;">编程开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/c77a4b/" class="nav-link">开发笔记</a></li><li class="dropdown-subitem"><a href="/pages/8503e3/" class="nav-link">安装笔记</a></li><li class="dropdown-subitem"><a href="/pages/6ec23d/" class="nav-link">sqlalchemy</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/23f6e2/" class="nav-link">开发笔记</a></li></ul></li><li class="dropdown-item"><h4>Shell</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages//" class="nav-link">安装部署</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/weiyong.jpeg"> <div class="blogger-info"><h3>yong.wei</h3> <span>
        数据库小学生
      </span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统" class="dropdown-title"><a href="/system/" class="link-title">系统</a> <span class="title" style="display:none;">系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>系统文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/654590/" class="nav-link">Linux维护手册</a></li><li class="dropdown-subitem"><a href="/pages/85d59c/" class="nav-link">使用iotune测试磁盘读写</a></li><li class="dropdown-subitem"><a href="/pages/45c411/" class="nav-link">源码编译gcc</a></li><li class="dropdown-subitem"><a href="/pages/187f4d/" class="nav-link">YCSB压测</a></li><li class="dropdown-subitem"><a href="/pages/ca2bd6/" class="nav-link">write ahead</a></li></ul></li><li class="dropdown-item"><h4>编程开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages//" class="nav-link">编程开发</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><a href="/mysql/" class="link-title">MySQL</a> <span class="title" style="display:none;">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>运维相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a6ac55/" class="nav-link">部署</a></li></ul></li><li class="dropdown-item"><h4>HA</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/c78f1b/" class="nav-link">HA选型</a></li><li class="dropdown-subitem"><a href="/pages/0439fa/" class="nav-link">MGR</a></li></ul></li><li class="dropdown-item"><h4>备份恢复</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a0df55/" class="nav-link">备份恢复实践</a></li></ul></li><li class="dropdown-item"><h4>笔记文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ee31c0/" class="nav-link">MySQL8新特性</a></li><li class="dropdown-subitem"><a href="/pages/08b679/" class="nav-link">SQL优化</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PostgreSQL" class="dropdown-title"><a href="/postgresql/" class="link-title">PostgreSQL</a> <span class="title" style="display:none;">PostgreSQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>运维相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/859ac7/" class="nav-link">部署</a></li><li class="dropdown-subitem"><a href="/pages/2373b5/" class="nav-link">运维手册</a></li></ul></li><li class="dropdown-item"><h4>备份恢复</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/96963a/" class="nav-link">备份恢复实践</a></li></ul></li><li class="dropdown-item"><h4>源码开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ddbfb5/" class="nav-link">统计SQL执行耗时分位</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><a href="/distributed/" class="link-title">分布式</a> <span class="title" style="display:none;">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Greenplum</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/441817/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/dee4e3/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/4bb09b/" class="nav-link">维护手册</a></li><li class="dropdown-subitem"><a href="/pages/84a443/" class="nav-link">监控指标</a></li></ul></li><li class="dropdown-item"><h4>Scylladb</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2cae68/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/342275/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/95d8cc/" class="nav-link">维护手册</a></li><li class="dropdown-subitem"><a href="/pages/e27c40/" class="nav-link">数据迁移</a></li><li class="dropdown-subitem"><a href="/pages/cf45d3/" class="nav-link">监控部署</a></li></ul></li><li class="dropdown-item"><h4>Aerospike</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bd9ddc/" class="nav-link">架构介绍</a></li><li class="dropdown-subitem"><a href="/pages/80ee1a/" aria-current="page" class="nav-link router-link-exact-active router-link-active">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/9ba431/" class="nav-link">管理手册</a></li><li class="dropdown-subitem"><a href="/pages/76e199/" class="nav-link">ACT测试</a></li><li class="dropdown-subitem"><a href="/pages/4131aa/" class="nav-link">源码编译</a></li><li class="dropdown-subitem"><a href="/pages/75d8ce/" class="nav-link">数据加载</a></li></ul></li><li class="dropdown-item"><h4>Vertica</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b023ab/" class="nav-link">安装部署</a></li></ul></li><li class="dropdown-item"><h4>Tidb</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a52d49/" class="nav-link">数据迁移</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NoSQL" class="dropdown-title"><a href="/nosql/" class="link-title">NoSQL</a> <span class="title" style="display:none;">NoSQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Redis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b9b610/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/5cdb24/" class="nav-link">性能测试</a></li><li class="dropdown-subitem"><a href="/pages/52f09b/" class="nav-link">运维手册</a></li><li class="dropdown-subitem"><a href="/pages/855952/" class="nav-link">安全加固</a></li><li class="dropdown-subitem"><a href="/pages/fea0b7/" class="nav-link">HA</a></li><li class="dropdown-subitem"><a href="/pages/dee4e3/" class="nav-link">新特性</a></li></ul></li><li class="dropdown-item"><h4>MongoDB</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/61caf7/" class="nav-link">安装部署</a></li><li class="dropdown-subitem"><a href="/pages/e25894/" class="nav-link">HA</a></li><li class="dropdown-subitem"><a href="/pages/7de6de/" class="nav-link">运维手册</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程开发" class="dropdown-title"><a href="/dev/" class="link-title">编程开发</a> <span class="title" style="display:none;">编程开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/c77a4b/" class="nav-link">开发笔记</a></li><li class="dropdown-subitem"><a href="/pages/8503e3/" class="nav-link">安装笔记</a></li><li class="dropdown-subitem"><a href="/pages/6ec23d/" class="nav-link">sqlalchemy</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/23f6e2/" class="nav-link">开发笔记</a></li></ul></li><li class="dropdown-item"><h4>Shell</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages//" class="nav-link">安装部署</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Greenplum</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ScyllaDB</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Aerospike</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bd9ddc/" class="sidebar-link">架构介绍</a></li><li><a href="/pages/80ee1a/" aria-current="page" class="active sidebar-link">安装部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/80ee1a/#系统环境" class="sidebar-link">系统环境</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#ssd配置" class="sidebar-link">SSD配置</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#as配置" class="sidebar-link">AS配置</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#服务管理" class="sidebar-link">服务管理</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#基准测试" class="sidebar-link">基准测试</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#测试结果" class="sidebar-link">测试结果</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#amc图形监控界面" class="sidebar-link">AMC图形监控界面</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#yscb压测实现百万qps" class="sidebar-link">YSCB压测实现百万QPS</a></li><li class="sidebar-sub-header"><a href="/pages/80ee1a/#服务监控" class="sidebar-link">服务监控</a></li></ul></li><li><a href="/pages/9ba431/" class="sidebar-link">管理手册</a></li><li><a href="/pages/76e199/" class="sidebar-link">ACT基准测试</a></li><li><a href="/pages/4131aa/" class="sidebar-link">源码编译安装</a></li><li><a href="/pages/75d8ce/" class="sidebar-link">加载数据</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vertica</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TiDB</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper"><div class="articleInfo-wrap" data-v-f6108aee><div class="articleInfo" data-v-f6108aee><ul class="breadcrumbs" data-v-f6108aee><li data-v-f6108aee><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-f6108aee></a></li> <li data-v-f6108aee><a href="/distributed" title="分布式-目录页" data-v-f6108aee>分布式</a></li> <li data-v-f6108aee><a href="/distributed/#Aerospike" title="分布式#Aerospike" data-v-f6108aee>Aerospike</a></li></ul> <div class="info" data-v-f6108aee><div title="作者" class="author iconfont icon-touxiang" data-v-f6108aee><a href="javascript:;" data-v-f6108aee>yong.wei</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f6108aee><a href="javascript:;" data-v-f6108aee>2020-06-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          Centos下实现百万QPS的Aerospike集群
        </h1> <div class="theme-vdoing-content content__default"><h1 id="centos下实现百万qps的aerospike集群"><a href="#centos下实现百万qps的aerospike集群" class="header-anchor">#</a> Centos下实现百万QPS的Aerospike集群</h1> <h2 id="系统环境"><a href="#系统环境" class="header-anchor">#</a> 系统环境</h2> <ul><li><p>OS</p> <p>Linux 3.10.0-862.el7.x86_64 #1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</p></li> <li><p>IP</p> <ul><li>1.1.1.1 node1</li> <li>1.1.1.2 node2</li> <li>1.1.1.3 node3</li></ul></li> <li><p>硬件</p> <p>24core、64GB、5.5TB sata盘、万M网卡。</p></li></ul> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <ul><li><a href="https://www.aerospike.com/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下载rpm包</li></ul> <blockquote><p>wget -O aerospike-server-community.tgz 'http://aerospike.com/download/server/latest/artifact/el7'</p></blockquote> <ul><li>aerospike-server-community-3.6.0-1.el6.x86_64.rpm（必须）</li> <li>aerospike-tools-3.8.2-1.el7.x86_64.rpm（必须）</li> <li>aerospike-amc-community-4.0.27-1.x86_64.rpm（可选）</li></ul> <p>使用rpm安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># rpm -ivh aerospike-server-community-3.6.0-1.el6.x86_64.rpm</span>
Preparing<span class="token punctuation">..</span>.                          <span class="token comment">################################# [100%]</span>
Adding group aerospike
Adding user aerospike
Updating / installing<span class="token punctuation">..</span>.
   <span class="token number">1</span>:aerospike-server-community-3.6.0-<span class="token comment">################################# [100%]</span>

<span class="token comment"># rpm -ivh aerospike-tools-3.8.2-1.el7.x86_64.rpm</span>
Preparing<span class="token punctuation">..</span>.                          <span class="token comment">################################# [100%]</span>
Installing /opt/aerospike
Updating / installing<span class="token punctuation">..</span>.
   <span class="token number">1</span>:aerospike-tools-3.8.2-1.el7      <span class="token comment">################################# [100%]</span>
Writing /usr/lib64/python2.7/site-packages/aerospike.pth
Adding python path /opt/aerospike/lib/python
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="ssd配置"><a href="#ssd配置" class="header-anchor">#</a> SSD配置</h2> <p>如果使用的是文件系统，则跳过此步骤。</p> <ul><li><p>清理ssd - <code>dd if=/dev/zero of=/dev/nvme0n1 bs=8M</code></p></li> <li><p>ssd分区，分区容量是全部容量*0.79</p></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">parted</span> -s /dev/nvme0n1 print
<span class="token function">parted</span> -s /dev/nvme0n1 mklabel gpt
<span class="token function">parted</span> -s /dev/nvme0n1 mkpart  primary  <span class="token number">1</span> <span class="token number">79</span>%
<span class="token function">parted</span> -s /dev/nvme0n1 print
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="as配置"><a href="#as配置" class="header-anchor">#</a> AS配置</h2> <p>执行<code>/opt/aerospike/bin/afterburner.sh</code>，这里会根据系统硬件情况配置<code>service-threads</code>、<code>fabric-workers</code>、<code>transaction-queues</code>、<code>transaction-threads-per-queue</code>、<code>client-fd-max</code>。</p> <p><strong>提示：</strong>
这里用到<code>/opt/aerospike/bin/helper_afterburner.sh</code>这个脚本，需要按core数量增加相应的内容。如果不配置irq，发挥不了最大性能，大概损失20%的QPS。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>IRQ_AFFINITY_FOR_CORE[12]=1
IRQ_AFFINITY_FOR_CORE[13]=2
IRQ_AFFINITY_FOR_CORE[14]=4
IRQ_AFFINITY_FOR_CORE[15]=8
IRQ_AFFINITY_FOR_CORE[16]=10
IRQ_AFFINITY_FOR_CORE[17]=20
IRQ_AFFINITY_FOR_CORE[18]=40
IRQ_AFFINITY_FOR_CORE[19]=80
IRQ_AFFINITY_FOR_CORE[20]=100
IRQ_AFFINITY_FOR_CORE[21]=200
IRQ_AFFINITY_FOR_CORE[22]=400
IRQ_AFFINITY_FOR_CORE[23]=800
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>编辑配置文件<code>/etc/aerospike/aerospike.conf</code>，修改下面项</p> <ul><li>mesh-seed-address-port 10.10.4.199 3002 - 种子节点地址及端口，一般选择3个节点即可</li> <li>paxos-max-cluster-size 60 - 集群最大节点数，默认是30</li> <li>migrate-threads 10 - migrate进程数量，默认是1，影响数据重分布的速度</li></ul> <p>这里我配置的namespace叫testns，主要配置以下3项，可以配置多个ns，每个ns都可以有不同的配置。</p> <ul><li>replication-factor 2 - 副本数</li> <li>memory-size 60G - 内存使用率</li> <li>namespace testns - namespace名称</li> <li>storage-engine - 配置持久化存储，可以是文件系统、SSD、内存等
<ul><li>file /opt/aerospike/data/testns.dat - 使用文件系统，建议多个文件分担写入压力。</li> <li>device	/dev/sdb1 - 使用SSD</li></ul></li> <li>high-water-memory-pct - 内存高水位，默认是50</li></ul> <p>其他项目可以根据需要调整。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># Aerospike database configuration file.</span>

<span class="token function">service</span> <span class="token punctuation">{</span>
	user root
	group root
	paxos-single-replica-limit <span class="token number">1</span> <span class="token comment"># Number of nodes where the replica count is automatically reduced to 1.</span>
	pidfile /var/run/aerospike/asd.pid
	<span class="token comment"># TODO: service-threads should be five times the number of CPUs when</span>
	<span class="token comment"># there is at least one SSD namespace, otherwise the number of CPUs.</span>
	service-threads <span class="token number">24</span>
	transaction-queues <span class="token number">24</span>
	transaction-threads-per-queue <span class="token number">3</span>
	proto-fd-max <span class="token number">50000</span>
	fabric-workers <span class="token number">72</span>
	paxos-max-cluster-size <span class="token number">60</span>
  	migrate-threads <span class="token number">10</span>
  	<span class="token comment">#log-local-time true</span>
<span class="token punctuation">}</span>

logging <span class="token punctuation">{</span>
	<span class="token comment"># Log file must be an absolute path.</span>
	<span class="token function">file</span> /var/log/aerospike/aerospike.log <span class="token punctuation">{</span>
		context any info
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

network <span class="token punctuation">{</span>
	<span class="token function">service</span> <span class="token punctuation">{</span>
		address any
		port <span class="token number">3000</span>
	<span class="token punctuation">}</span>

	heartbeat <span class="token punctuation">{</span>
                mode mesh
                port <span class="token number">3002</span> <span class="token comment"># Heartbeat port for this node.</span>

                <span class="token comment"># List one or more other nodes, one ip-address &amp; port per line:</span>
                mesh-seed-address-port <span class="token number">1.1</span>.1.1 <span class="token number">3002</span>

		<span class="token comment"># To use unicast-mesh heartbeats, remove the 3 lines above, and see</span>
		<span class="token comment"># aerospike_mesh.conf for alternative.</span>

		interval <span class="token number">150</span>
		<span class="token function">timeout</span> <span class="token number">10</span>
	<span class="token punctuation">}</span>

	fabric <span class="token punctuation">{</span>
		port <span class="token number">3001</span>
	<span class="token punctuation">}</span>

	info <span class="token punctuation">{</span>
		port <span class="token number">3003</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

namespace testns <span class="token punctuation">{</span>
	<span class="token comment">#default-ttl &lt;VALUE&gt;             # How long (in seconds) to keep data after</span>
                                   <span class="token comment"># it is written</span>
	replication-factor <span class="token number">2</span>
	memory-size 60G
	high-water-memory-pct <span class="token number">85</span>
  	high-water-disk-pct <span class="token number">90</span>
<span class="token comment">#	storage-engine memory</span>
<span class="token comment">#        ldt-enabled   true</span>

	<span class="token comment"># To use file storage backing, comment out the line above and use the</span>
	<span class="token comment"># following lines instead.</span>
	storage-engine device <span class="token punctuation">{</span>
<span class="token comment">#		device	/dev/sdb1</span>
		<span class="token function">file</span> /opt/aerospike/data/testns1.dat
		<span class="token function">file</span> /opt/aerospike/data/testns2.dat
		<span class="token function">file</span> /opt/aerospike/data/testns3.dat
		filesize 20G
		write-block-size 128K
		scheduler-mode noop
       defrag-sleep <span class="token number">0</span>
<span class="token comment">#		data-in-memory false # Store data in memory in addition to file.</span>
	<span class="token punctuation">}</span>

	<span class="token comment">#set &lt;set-name&gt; {</span>
   <span class="token comment">#     set-disable-eviction true   # Protect this set from evictions.</span>
   <span class="token comment">#     set-stop-writes-count 5000  # Limit number of records that can be written to this set to 5000.</span>
   <span class="token comment"># }</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h2 id="服务管理"><a href="#服务管理" class="header-anchor">#</a> 服务管理</h2> <ul><li>启动服务</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">service</span> aerospike start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>查看服务</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>	Monitor<span class="token operator">&gt;</span> info
<span class="token operator">==</span><span class="token operator">=</span>NODES<span class="token operator">==</span><span class="token operator">=</span>
<span class="token number">2019</span>-09-23 <span class="token number">11</span>:58:46.586647
Sorting by IP, <span class="token keyword">in</span> Ascending order:
ip:port                                           Build   Cluster      Cluster   Free   Free   Migrates              Node         Principal   Replicated    Sys
                                                      <span class="token builtin class-name">.</span>      Size   Visibility   Disk    Mem          <span class="token builtin class-name">.</span>                ID                ID      Objects   Free
                                                      <span class="token builtin class-name">.</span>         <span class="token builtin class-name">.</span>            <span class="token builtin class-name">.</span>    pct    pct          <span class="token builtin class-name">.</span>                 <span class="token builtin class-name">.</span>                 <span class="token builtin class-name">.</span>            <span class="token builtin class-name">.</span>    Mem
node1:3000    <span class="token number">3.6</span>.0         <span class="token number">3</span>         <span class="token boolean">true</span>    <span class="token number">100</span>    <span class="token number">100</span>      <span class="token punctuation">(</span><span class="token number">0,0</span><span class="token punctuation">)</span>   BB9606276EC0214   BB9D09D3D966E24            <span class="token number">0</span>     <span class="token number">79</span>
node2:3000    <span class="token number">3.6</span>.0         <span class="token number">3</span>         <span class="token boolean">true</span>    <span class="token number">100</span>    <span class="token number">100</span>      <span class="token punctuation">(</span><span class="token number">0,0</span><span class="token punctuation">)</span>   BB968A5BFBBF4EC   BB9D09D3D966E24            <span class="token number">0</span>      <span class="token number">3</span>
node3:3000    <span class="token number">3.6</span>.0         <span class="token number">3</span>         <span class="token boolean">true</span>    <span class="token number">100</span>    <span class="token number">100</span>      <span class="token punctuation">(</span><span class="token number">0,0</span><span class="token punctuation">)</span>   BB9D09D3D966E24   BB9D09D3D966E24            <span class="token number">0</span>      <span class="token number">2</span>
Number of nodes displayed: <span class="token number">3</span>


 <span class="token operator">==</span><span class="token operator">=</span>NAMESPACE<span class="token operator">==</span><span class="token operator">=</span>
Total <span class="token punctuation">(</span>unique<span class="token punctuation">)</span> objects <span class="token keyword">in</span> cluster <span class="token keyword">for</span> testns <span class="token builtin class-name">:</span> <span class="token number">0</span>
Note: Total <span class="token punctuation">(</span>unique<span class="token punctuation">)</span> objects is an under estimate <span class="token keyword">if</span> migrations are <span class="token keyword">in</span> progress.


ip/namespace                                        Avail   Evicted    Master     Repl     Stop     Used   Used     Used   Used    hwm   hwm
                                                      Pct   Objects   Objects   Factor   Writes     Disk   Disk      Mem    Mem   Disk   Mem
                                                        <span class="token builtin class-name">.</span>         <span class="token builtin class-name">.</span>         <span class="token builtin class-name">.</span>        <span class="token builtin class-name">.</span>        <span class="token builtin class-name">.</span>        <span class="token builtin class-name">.</span>      %        <span class="token builtin class-name">.</span>      %      <span class="token builtin class-name">.</span>     <span class="token builtin class-name">.</span>
node1/testns       <span class="token number">99</span>         <span class="token number">0</span>         <span class="token number">0</span>        <span class="token number">2</span>    <span class="token boolean">false</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>     <span class="token number">50</span>    <span class="token number">75</span>
node2/testns       <span class="token number">99</span>         <span class="token number">0</span>         <span class="token number">0</span>        <span class="token number">2</span>    <span class="token boolean">false</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>     <span class="token number">50</span>    <span class="token number">75</span>
node3/testns       <span class="token number">99</span>         <span class="token number">0</span>         <span class="token number">0</span>        <span class="token number">2</span>    <span class="token boolean">false</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>   <span class="token number">0.00</span> B      <span class="token number">0</span>     <span class="token number">50</span>    <span class="token number">75</span>
Number of rows displayed: <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><ul><li>参数修改</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>asinfo -v <span class="token string">'get-config:'</span> -l <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'proto-fd'</span>
asinfo -v <span class="token string">&quot;set-config:context=namespace;id=testns;high-water-memory-pct=75&quot;</span>
asadm -e <span class="token string">&quot;asinfo -v 'set-config:context=service;proto-fd-max=150000'&quot;</span>
asinfo -v <span class="token string">&quot;set-config:context=service;proto-fd-max=50000&quot;</span>
asinfo -v <span class="token string">'set-config:context=service;migrate-threads=10'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>查看数据重分布情况</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>asmonitor&gt;info
查看Migrates的值，都是（0,0）表示同步完成。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="基准测试"><a href="#基准测试" class="header-anchor">#</a> 基准测试</h2> <p>github下载<a href="https://github.com/aerospike/aerospike-client-java" target="_blank" rel="noopener noreferrer">aerospike-client-java<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>包，编译后即可使用。</p> <p><strong>Example 1</strong></p> <ul><li><p>Connect to localhost:3000 using test namespace.</p></li> <li><p>Read 10% and write 90% of the time using 20 concurrent threads.</p></li> <li><p>Use 100000000 integer keys (starting at &quot;1&quot;) and 50 character string values.</p></li> <li><p>Benchmark synchronous methods.</p> <p><code>asbenchmark -h 127.0.0.1 -p 3000 -n testns -k 100000000 -S 1 -o S:50 -w RU,10 -z 20</code></p></li></ul> <p><strong>Example 2</strong></p> <ul><li><p>Connect to localhost:3000 using test namespace.</p></li> <li><p>Read 80% and write 20% of the time using 8 concurrent threads.</p></li> <li><p>Use 10000000 integer keys and 1400 bytes values using a single bin.</p></li> <li><p>Timeout after 50ms for reads and writes.</p></li> <li><p>Restrict transactions/second to 2500.</p></li> <li><p>Benchmark synchronous methods.</p> <p><code>asbenchmark -h 127.0.0.1 -p 3000 -n testns -k 10000000 -b 1 -o B:1400 -w RU,80 -g 2500 -T 50 -z 8</code></p></li></ul> <p><strong>Example 3</strong></p> <ul><li><p>Benchmark asynchronous methods using a single producer thread and 4 selector threads.</p></li> <li><p>Limit the maximum number of concurrent commands to 200.</p></li> <li><p>Use and 50% read 50% write pattern.</p> <p><code>asbenchmark -h 127.0.0.1 -p 3000 -n testns -k 100000000 -S 1 -o S:50 -w RU,50 -z 1 -async -asyncMaxCommands 200 -asyncSelectorThreads 4</code></p></li></ul> <h2 id="测试结果"><a href="#测试结果" class="header-anchor">#</a> 测试结果</h2> <p><code>./run_benchmarks -h 127.0.0.1 -p 3000 -n testns -k 10000000 -b 1 -o B:1400 -w RU,90 -T 50 -z 16</code></p> <table><thead><tr><th></th> <th>memory</th> <th>HDD + data-in-memory</th> <th>HDD</th></tr></thead> <tbody><tr><td>tps</td> <td>14.3w</td> <td>13.5w</td> <td>12.7w</td></tr></tbody></table> <blockquote><p>根据测试，3节点SSD的读OPS可以达到50W+，写OPS在13W左右，读OPS可以随着节点的增加大幅度增加，但是写OPS不会。</p></blockquote> <h2 id="amc图形监控界面"><a href="#amc图形监控界面" class="header-anchor">#</a> AMC图形监控界面</h2> <ol><li>启动amc服务 - <code>/etc/init.d/amc start</code></li> <li>浏览器打开 - <code>http://&lt;AMC Server IP&gt;:8081/</code> <img src="/img/aerospike/amc.png" alt=""></li></ol> <h2 id="yscb压测实现百万qps"><a href="#yscb压测实现百万qps" class="header-anchor">#</a> YSCB压测实现百万QPS</h2> <ul><li>YCSB安装使用参考<a href="/2019/10/29/ycsb-test/">使用YCSB压测各种NoSQL数据库</a></li> <li>3台服务器作为client，一台client产生不了百万QPS。</li> <li>设置workloada</li></ul> <blockquote><p>recordcount=100000000、operationcount=100000000</p></blockquote> <ul><li>load数据</li></ul> <blockquote><p>./bin/ycsb load aerospike -p as.host=&quot;&quot; -p as.port=&quot;3000&quot; -p as.namespace=&quot;test&quot; -P workloads/workloada -threads 200 -s</p></blockquote> <ul><li>运行测试</li></ul> <blockquote><p>./bin/ycsb run aerospike -p as.host=&quot;&quot; -p as.port=&quot;3000&quot; -p as.namespace=&quot;test&quot; -P workloads/workloada -threads 200 -s</p></blockquote> <ul><li>百万QPS达成
<img src="/img/aerospike/qps.png" alt=""></li></ul> <h2 id="服务监控"><a href="#服务监控" class="header-anchor">#</a> 服务监控</h2> <p>下面是监控小脚本，可以根据需要自行增加监控项目。</p> <p><strong>监控结果：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[
    {
        &quot;metric&quot;: &quot;aerospike.ns.free_pct_memory&quot;,
        &quot;value&quot;: 99.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.stop_writes&quot;,
        &quot;value&quot;: 0.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.free_pct_disk&quot;,
        &quot;value&quot;: 99.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.high_water_disk_pct&quot;,
        &quot;value&quot;: 50.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.high_water_memory_pct&quot;,
        &quot;value&quot;: 75.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.stop_writes_pct&quot;,
        &quot;value&quot;: 90.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;aerospike.ns.repl_factor&quot;,
        &quot;value&quot;: 1.0,
        &quot;data_type&quot;: &quot;gauge&quot;,
        &quot;tags&quot;: {
            &quot;namespace&quot;: &quot;testns&quot;,
            &quot;port&quot;: &quot;3000&quot;
        }
    }
]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p><strong>代码详情：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># Description: monitor script for Aerospike</span>

<span class="token keyword">import</span> sys
<span class="token keyword">import</span> types
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> re
<span class="token keyword">import</span> argparse
<span class="token keyword">import</span> struct
<span class="token keyword">import</span> time
<span class="token keyword">import</span> getpass
<span class="token keyword">from</span> ctypes <span class="token keyword">import</span> create_string_buffer



STATE_OK<span class="token operator">=</span><span class="token number">0</span>
STATE_WARNING<span class="token operator">=</span><span class="token number">1</span>
STATE_CRITICAL<span class="token operator">=</span><span class="token number">2</span>
STATE_UNKNOWN<span class="token operator">=</span><span class="token number">3</span>
STATE_DEPENDENT<span class="token operator">=</span><span class="token number">4</span>

arg_host <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span>
arg_port <span class="token operator">=</span> <span class="token number">3000</span>
arg_value <span class="token operator">=</span> <span class="token string">&quot;namespace/testns&quot;</span>
arg_stat <span class="token operator">=</span> <span class="token boolean">None</span>
user <span class="token operator">=</span> <span class="token boolean">None</span>
password <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment"># =============================================================================</span>
<span class="token comment">#</span>
<span class="token comment"># Client</span>
<span class="token comment">#</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

STRUCT_PROTO <span class="token operator">=</span> struct<span class="token punctuation">.</span>Struct<span class="token punctuation">(</span><span class="token string">'! Q'</span><span class="token punctuation">)</span>
STRUCT_AUTH <span class="token operator">=</span> struct<span class="token punctuation">.</span>Struct<span class="token punctuation">(</span><span class="token string">'! xxBB12x'</span><span class="token punctuation">)</span>
STRUCT_FIELD <span class="token operator">=</span> struct<span class="token punctuation">.</span>Struct<span class="token punctuation">(</span><span class="token string">'! IB'</span><span class="token punctuation">)</span>

MSG_VERSION <span class="token operator">=</span> <span class="token number">0</span>
MSG_TYPE <span class="token operator">=</span> <span class="token number">2</span>
AUTHENTICATE <span class="token operator">=</span> <span class="token number">0</span>
USER <span class="token operator">=</span> <span class="token number">0</span>
CREDENTIAL <span class="token operator">=</span> <span class="token number">3</span>
SALT <span class="token operator">=</span> <span class="token string">&quot;$2a$10$7EqJtq98hPqEX7fNZaFWoO&quot;</span>

<span class="token keyword">class</span> <span class="token class-name">ClientError</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">Client</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> port<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>addr <span class="token operator">=</span> addr
                self<span class="token punctuation">.</span>port <span class="token operator">=</span> port
                self<span class="token punctuation">.</span>timeout <span class="token operator">=</span> timeout
                self<span class="token punctuation">.</span>sock <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> keyfile<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> certfile<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ca_certs<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ciphers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> tls_enable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encrypt_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                capath<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> protocols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> cert_blacklist<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> crl_check<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> crl_check_all<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> tls_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                s <span class="token operator">=</span> <span class="token boolean">None</span>
                <span class="token keyword">for</span> res <span class="token keyword">in</span> socket<span class="token punctuation">.</span>getaddrinfo<span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>port<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>AF_UNSPEC<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        af<span class="token punctuation">,</span> socktype<span class="token punctuation">,</span> proto<span class="token punctuation">,</span> canonname<span class="token punctuation">,</span> sa <span class="token operator">=</span> res
                        ssl_context <span class="token operator">=</span> <span class="token boolean">None</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                                s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>af<span class="token punctuation">,</span> socktype<span class="token punctuation">,</span> proto<span class="token punctuation">)</span>
                        <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error <span class="token keyword">as</span> msg<span class="token punctuation">:</span>
                                s <span class="token operator">=</span> <span class="token boolean">None</span>
                                <span class="token keyword">continue</span>
                        <span class="token keyword">if</span> tls_enable<span class="token punctuation">:</span>
                                <span class="token keyword">from</span> ssl_context <span class="token keyword">import</span> SSLContext
                                <span class="token keyword">from</span> OpenSSL <span class="token keyword">import</span> SSL
                                ssl_context <span class="token operator">=</span> SSLContext<span class="token punctuation">(</span>enable_tls<span class="token operator">=</span>tls_enable<span class="token punctuation">,</span> encrypt_only<span class="token operator">=</span>encrypt_only<span class="token punctuation">,</span> cafile<span class="token operator">=</span>ca_certs<span class="token punctuation">,</span> capath<span class="token operator">=</span>capath<span class="token punctuation">,</span>
                                           keyfile<span class="token operator">=</span>keyfile<span class="token punctuation">,</span> certfile<span class="token operator">=</span>certfile<span class="token punctuation">,</span> protocols<span class="token operator">=</span>protocols<span class="token punctuation">,</span>
                                           cipher_suite<span class="token operator">=</span>ciphers<span class="token punctuation">,</span> cert_blacklist<span class="token operator">=</span>cert_blacklist<span class="token punctuation">,</span>
                                           crl_check<span class="token operator">=</span>crl_check<span class="token punctuation">,</span> crl_check_all<span class="token operator">=</span>crl_check_all<span class="token punctuation">)</span><span class="token punctuation">.</span>ctx
                                s <span class="token operator">=</span> SSL<span class="token punctuation">.</span>Connection<span class="token punctuation">(</span>ssl_context<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                                s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>sa<span class="token punctuation">)</span>
                                <span class="token keyword">if</span> ssl_context<span class="token punctuation">:</span>
                                        s<span class="token punctuation">.</span>set_app_data<span class="token punctuation">(</span>tls_name<span class="token punctuation">)</span>
                                        s<span class="token punctuation">.</span>do_handshake<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error <span class="token keyword">as</span> msg<span class="token punctuation">:</span>
                                s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                                s <span class="token operator">=</span> <span class="token boolean">None</span>
                                <span class="token keyword">print</span> <span class="token string">&quot;Connect Error&quot;</span> <span class="token operator">%</span> msg
                                <span class="token keyword">continue</span>
                        <span class="token keyword">break</span>

                <span class="token keyword">if</span> s <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                        <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span>
                                <span class="token string">&quot;Could not connect to server at %s %s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>

                self<span class="token punctuation">.</span>sock <span class="token operator">=</span> s
                <span class="token keyword">return</span> self

        <span class="token keyword">def</span> <span class="token function">close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>sock <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
                        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        self<span class="token punctuation">.</span>sock <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token keyword">def</span> <span class="token function">auth</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

                <span class="token keyword">import</span> bcrypt

                credential <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span>hashpw<span class="token punctuation">(</span>password<span class="token punctuation">,</span> SALT<span class="token punctuation">)</span>

                <span class="token keyword">if</span> timeout <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                        timeout <span class="token operator">=</span> self<span class="token punctuation">.</span>timeout

                l <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16</span>
                l <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
                l <span class="token operator">+=</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>credential<span class="token punctuation">)</span>

                buf <span class="token operator">=</span> create_string_buffer<span class="token punctuation">(</span>l<span class="token punctuation">)</span>
                offset <span class="token operator">=</span> <span class="token number">0</span>

                proto <span class="token operator">=</span> <span class="token punctuation">(</span>MSG_VERSION <span class="token operator">&lt;&lt;</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>MSG_TYPE <span class="token operator">&lt;&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>l <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span>
                STRUCT_PROTO<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> proto<span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> STRUCT_PROTO<span class="token punctuation">.</span>size

                STRUCT_AUTH<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> AUTHENTICATE<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> STRUCT_AUTH<span class="token punctuation">.</span>size

                STRUCT_FIELD<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> USER<span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> STRUCT_FIELD<span class="token punctuation">.</span>size
                fmt <span class="token operator">=</span> <span class="token string">&quot;! %ds&quot;</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
                struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>fmt<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> username<span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>

                STRUCT_FIELD<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>credential<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> CREDENTIAL<span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> STRUCT_FIELD<span class="token punctuation">.</span>size
                fmt <span class="token operator">=</span> <span class="token string">&quot;! %ds&quot;</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>credential<span class="token punctuation">)</span>
                struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>fmt<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> credential<span class="token punctuation">)</span>
                offset <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>credential<span class="token punctuation">)</span>

                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>

                buf <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
                rv <span class="token operator">=</span> STRUCT_PROTO<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
                proto <span class="token operator">=</span> rv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                pvers <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&gt;&gt;</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>
                ptype <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&gt;&gt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>
                psize <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFF</span><span class="token punctuation">)</span>

                buf <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>psize<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
                status <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> status <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span><span class="token string">&quot;Autentication Error %d for '%s' &quot;</span> <span class="token operator">%</span>
                                                          <span class="token punctuation">(</span>status<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">:</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                                r <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
                        <span class="token keyword">except</span> IOError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                                <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                        <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                                <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                        <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span><span class="token string">'socket not available'</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">send_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pvers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> ptype<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> request<span class="token punctuation">:</span>
                        request <span class="token operator">+=</span> <span class="token string">'\n'</span>
                sz <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span>
                buf <span class="token operator">=</span> create_string_buffer<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>
                offset <span class="token operator">=</span> <span class="token number">0</span>

                proto <span class="token operator">=</span> <span class="token punctuation">(</span>pvers <span class="token operator">&lt;&lt;</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>ptype <span class="token operator">&lt;&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
                STRUCT_PROTO<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> proto<span class="token punctuation">)</span>
                offset <span class="token operator">=</span> STRUCT_PROTO<span class="token punctuation">.</span>size

                fmt <span class="token operator">=</span> <span class="token string">&quot;! %ds&quot;</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
                struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span>fmt<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> request<span class="token punctuation">)</span>
                offset <span class="token operator">=</span> offset <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>

                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">:</span>
                out <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
                pos <span class="token operator">=</span> <span class="token number">0</span>
                start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">while</span> pos <span class="token operator">&lt;</span> sz<span class="token punctuation">:</span>
                        buf <span class="token operator">=</span> <span class="token boolean">None</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                                buf <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>sz<span class="token punctuation">)</span>
                        <span class="token keyword">except</span> IOError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                                <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> pos <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                                out <span class="token operator">=</span> buf
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                                out <span class="token operator">+=</span> buf
                        pos <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> timeout <span class="token keyword">and</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time <span class="token operator">&gt;</span> timeout<span class="token punctuation">:</span>
                                <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>timeout<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> out

        <span class="token keyword">def</span> <span class="token function">recv_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                buf <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
                rv <span class="token operator">=</span> STRUCT_PROTO<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
                proto <span class="token operator">=</span> rv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                pvers <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&gt;&gt;</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>
                ptype <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&gt;&gt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>
                psize <span class="token operator">=</span> <span class="token punctuation">(</span>proto <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFF</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> psize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        <span class="token keyword">return</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>psize<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>

        <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send_request<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
                res <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_response<span class="token punctuation">(</span>timeout<span class="token operator">=</span>self<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span>
                out <span class="token operator">=</span> re<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                        <span class="token keyword">return</span> out<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                        <span class="token keyword">raise</span> ClientError<span class="token punctuation">(</span><span class="token string">&quot;Failed to parse response: %s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">###</span>
<span class="token comment"># Argument parsing</span>
<span class="token comment">###</span>
parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>add_help<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-u'</span>
                    <span class="token punctuation">,</span> <span class="token string">'--usage'</span>
                    <span class="token punctuation">,</span> <span class="token string">'--help'</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;help&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Show this help message and exit&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-U&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--user&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;user name&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-P&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span>
                    <span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">&quot;?&quot;</span>
                    <span class="token punctuation">,</span> const<span class="token operator">=</span><span class="token string">&quot;prompt&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-v&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--verbose&quot;</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;store_true&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;verbose&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Enable verbose logging&quot;</span><span class="token punctuation">)</span>
group <span class="token operator">=</span> parser<span class="token punctuation">.</span>add_mutually_exclusive_group<span class="token punctuation">(</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-n&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--namespace&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;namespace&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Namespace name. eg: bar&quot;</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-l&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--latency&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;latency&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Options: see output of asinfo -v 'latency:hist' -l&quot;</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-x&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--xdr&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;dc&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Datacenter name. eg: myDC1&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-s&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--stat&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;stat&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Statistic name. eg: cluster_size&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-p&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;---port&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;port&quot;</span>
                    <span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">3000</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;PORT for Aerospike server (default: %(default)s)&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-h&quot;</span>
                    <span class="token punctuation">,</span> <span class="token string">&quot;--host&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;host&quot;</span>
                    <span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;HOST for Aerospike server (default: %(default)s)&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-d&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;dummy&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Dummy variable for templating&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_enable&quot;</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;store_true&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_enable&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Enable TLS&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_encrypt_only&quot;</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;store_true&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_encrypt_only&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;TLS Encrypt Only&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_keyfile&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_keyfile&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The private keyfile for your client TLS Cert&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_certfile&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_certfile&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The client TLS cert&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_cafile&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_cafile&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The CA for the server's certificate&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_capath&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_capath&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The path to a directory containing CA certs and/or CRLs&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_protocols&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_protocols&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The TLS protocol to use. Available choices: SSLv2, SSLv3, TLSv1, TLSv1.1, TLSv1.2, all. An optional + or - can be appended before the protocol to indicate specific inclusion or exclusion.&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_blacklist&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_blacklist&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Blacklist including serial number of certs to revoke&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_ciphers&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_ciphers&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Ciphers to include. See https://www.openssl.org/docs/man1.0.1/apps/ciphers.html for cipher list format&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_crl&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_crl&quot;</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;store_true&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Checks SSL/TLS certs against vendor's Certificate Revocation Lists for revoked certificates. CRLs are found in path specified by --tls_capath. Checks the leaf certificates only&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_crlall&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_crlall&quot;</span>
                    <span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">&quot;store_true&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Check on all entries within the CRL chain&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--tls_name&quot;</span>
                    <span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">&quot;tls_name&quot;</span>
                    <span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;The expected name on the server side certificate&quot;</span><span class="token punctuation">)</span>

args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> args<span class="token punctuation">.</span>dc<span class="token punctuation">:</span>
  arg_value<span class="token operator">=</span><span class="token string">'dc/'</span><span class="token operator">+</span>args<span class="token punctuation">.</span>dc
<span class="token keyword">elif</span> args<span class="token punctuation">.</span>namespace<span class="token punctuation">:</span>
  arg_value<span class="token operator">=</span><span class="token string">'namespace/'</span><span class="token operator">+</span>args<span class="token punctuation">.</span>namespace
<span class="token keyword">elif</span> args<span class="token punctuation">.</span>latency<span class="token punctuation">:</span>
  arg_value<span class="token operator">=</span><span class="token string">'latency:hist='</span><span class="token operator">+</span>args<span class="token punctuation">.</span>latency

user <span class="token operator">=</span> <span class="token boolean">None</span>
password <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> args<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> args<span class="token punctuation">.</span>user
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>password <span class="token operator">==</span> <span class="token string">&quot;prompt&quot;</span><span class="token punctuation">:</span>
        args<span class="token punctuation">.</span>password <span class="token operator">=</span> getpass<span class="token punctuation">.</span>getpass<span class="token punctuation">(</span><span class="token string">&quot;Enter Password:&quot;</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> args<span class="token punctuation">.</span>password


<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment">#client = aerospike.client(config).connect(user,password)</span>
    client <span class="token operator">=</span> Client<span class="token punctuation">(</span>addr<span class="token operator">=</span>args<span class="token punctuation">.</span>host<span class="token punctuation">,</span>port<span class="token operator">=</span>args<span class="token punctuation">.</span>port<span class="token punctuation">)</span>
    client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>keyfile<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_keyfile<span class="token punctuation">,</span> certfile<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_certfile<span class="token punctuation">,</span> ca_certs<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_cafile<span class="token punctuation">,</span> ciphers<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_ciphers<span class="token punctuation">,</span> tls_enable<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_enable<span class="token punctuation">,</span>
                   encrypt_only<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_encrypt_only<span class="token punctuation">,</span> capath<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_capath<span class="token punctuation">,</span> protocols<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_protocols<span class="token punctuation">,</span> cert_blacklist<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_blacklist<span class="token punctuation">,</span>
                   crl_check<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_crl<span class="token punctuation">,</span>crl_check_all<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_crlall<span class="token punctuation">,</span> tls_name<span class="token operator">=</span>args<span class="token punctuation">.</span>tls_name<span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to connect to the Aerospike cluster at %s:%s&quot;</span><span class="token operator">%</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>host<span class="token punctuation">,</span>args<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> e
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>STATE_UNKNOWN<span class="token punctuation">)</span>

<span class="token comment">#r = client.info_node(arg_value,(arg_host,arg_port))</span>
r <span class="token operator">=</span> client<span class="token punctuation">.</span>info<span class="token punctuation">(</span>arg_value<span class="token punctuation">)</span>
client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#pprint.pprint(r)</span>

<span class="token keyword">if</span> args<span class="token punctuation">.</span>stat <span class="token operator">!=</span> <span class="token boolean">None</span> <span class="token keyword">and</span> args<span class="token punctuation">.</span>stat <span class="token keyword">not</span> <span class="token keyword">in</span> r<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&quot;%s is not a known statistic.&quot;</span> <span class="token operator">%</span>args<span class="token punctuation">.</span>stat
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>STATE_UNKNOWN<span class="token punctuation">)</span>

<span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&quot;request to &quot;</span><span class="token punctuation">,</span>args<span class="token punctuation">.</span>host<span class="token punctuation">,</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span>args<span class="token punctuation">.</span>port<span class="token punctuation">,</span><span class="token string">&quot; returned error.&quot;</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>STATE_CRITICAL<span class="token punctuation">)</span>

<span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&quot;request to &quot;</span><span class="token punctuation">,</span>args<span class="token punctuation">.</span>host<span class="token punctuation">,</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span>args<span class="token punctuation">.</span>port<span class="token punctuation">,</span><span class="token string">&quot; returned no data.&quot;</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>STATE_CRITICAL<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;[&quot;</span>
first <span class="token operator">=</span> <span class="token boolean">True</span>
r <span class="token operator">=</span> r<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> s <span class="token keyword">in</span> r<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    metricname<span class="token operator">=</span>re<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'=|\t'</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    metricvalue<span class="token operator">=</span>s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>stat <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>stat <span class="token operator">!=</span> metricname<span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
    <span class="token keyword">if</span> metricname <span class="token operator">!=</span> <span class="token string">&quot;stop-writes&quot;</span> <span class="token keyword">and</span> metricname <span class="token operator">!=</span> <span class="token string">&quot;free-pct-disk&quot;</span> <span class="token keyword">and</span>  metricname <span class="token operator">!=</span> <span class="token string">&quot;free-pct-memory&quot;</span> <span class="token keyword">and</span>  metricname <span class="token operator">!=</span><span class="token string">&quot;high-water-disk-pct&quot;</span> <span class="token keyword">and</span> metricname <span class="token operator">!=</span> <span class="token string">&quot;high-water-memory-pct&quot;</span> <span class="token keyword">and</span> metricname <span class="token operator">!=</span> <span class="token string">&quot;stop-writes-pct&quot;</span> <span class="token keyword">and</span>  metricname <span class="token operator">!=</span> <span class="token string">&quot;repl-factor&quot;</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> first<span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token string">&quot;,&quot;</span>
    first <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">if</span> metricvalue <span class="token operator">==</span> <span class="token string">&quot;true&quot;</span> <span class="token keyword">or</span> metricvalue <span class="token operator">==</span> <span class="token string">&quot;on&quot;</span><span class="token punctuation">:</span>
        metricvalue <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span>
    <span class="token keyword">elif</span> metricvalue <span class="token operator">==</span> <span class="token string">&quot;false&quot;</span> <span class="token keyword">or</span> metricvalue <span class="token operator">==</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">:</span>
        metricvalue <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span>
    <span class="token keyword">if</span> metricname <span class="token operator">==</span> <span class="token string">&quot;cluster_key&quot;</span><span class="token punctuation">:</span>
        metricvalue <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>metricvalue<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Convert HEX id to numerical</span>
    <span class="token keyword">print</span> <span class="token string">&quot;{&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t\&quot;metric\&quot;:\&quot;aerospike.ns.&quot;</span><span class="token operator">+</span>metricname<span class="token operator">+</span><span class="token string">&quot;\&quot;,&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t\&quot;data_type\&quot;: \&quot;gauge\&quot;,&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t\&quot;value\&quot;:&quot;</span><span class="token operator">+</span>metricvalue<span class="token operator">+</span><span class="token string">&quot;,&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t\&quot;tags\&quot;: {&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t\&quot;namespace\&quot;:\&quot;push\&quot;&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;\t}&quot;</span>
    <span class="token keyword">print</span> <span class="token string">&quot;}&quot;</span>

<span class="token keyword">print</span> <span class="token string">&quot;]&quot;</span>
sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>STATE_OK<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br></div></div></div></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020/07/10, 18:07:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/bd9ddc/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">
        架构介绍
      </div></a> <a href="/pages/9ba431/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">
        管理手册
      </div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/bd9ddc/" class="prev">架构介绍</a></span> <span class="next"><a href="/pages/9ba431/">管理手册</a>
        →
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/fe6a06/"><div>分区维护</div></a> <span>11-25</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/ca2bd6/"><div>验证write ahead是否有效</div></a> <span>10-16</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/64607c/"><div>使用undrop-for-innodb恢复数据</div></a> <span>09-25</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="mailto:583675636@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
     | Copyright © 2020-2020
    <span>yong.wei | <a href="" target="_blank"></a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b45ba360.js" defer></script><script src="/assets/js/2.6eac6864.js" defer></script><script src="/assets/js/3.a88a92d5.js" defer></script><script src="/assets/js/49.7ee1a812.js" defer></script>
  </body>
</html>